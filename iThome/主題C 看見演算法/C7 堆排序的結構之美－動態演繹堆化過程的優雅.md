### **å¼•è¨€**
åœ¨æˆ‘å€‘å‰é¢çš„æ–‡ç« ä¸­ï¼Œæˆ‘å€‘æ¢è¨äº†ä»¥ã€Œåˆ†æ²»æ³•ã€ç‚ºåŸºç¤çš„æ’åºæ¼”ç®—æ³•ï¼Œä¾‹å¦‚å¿«é€Ÿæ’åºå’Œåˆä½µæ’åºï¼Œä¸¦å±•ç¤ºäº†å®ƒå€‘å¦‚ä½•åœ¨å‰ç«¯ç‰¹æ•ˆæ‡‰ç”¨ä¸­é€²è¡Œè¦–è¦ºåŒ–è™•ç†ã€‚ç„¶è€Œï¼Œé™¤äº†åˆ†æ²»æ³•ï¼Œå¦ä¸€å€‹ç¶“å…¸ä¸”é«˜æ•ˆçš„æ’åºæ¼”ç®—æ³•æ˜¯ã€Œå †æ’åºã€ï¼ˆHeap Sortï¼‰ï¼Œå®ƒåŸºæ–¼å®Œå…¨äºŒå…ƒæ¨¹çš„ç‰¹æ€§ä¾†é€²è¡Œæ’åºæ“ä½œã€‚

ä»Šå¤©ï¼Œæˆ‘å€‘å°‡ä»‹ç´¹å †æ’åºçš„åŸºæœ¬æ¦‚å¿µï¼Œä¸¦é€šéç¨‹å¼ç¢¼é€æ­¥å±•ç¤ºå…¶è¦–è¦ºåŒ–å¯¦ä½œã€‚é€™ç¯‡æ–‡ç« å°‡é‡é»æ”¾åœ¨æ¼”ç®—æ³•æ­¥é©Ÿçš„å‹•ç•«åŒ–è™•ç†ï¼Œè®“ä½ çœ‹åˆ°å¦‚ä½•åœ¨å‰ç«¯å‹•ç•«ç³»çµ±ä¸­ä»¥ç›´è§€æ–¹å¼å‘ˆç¾å †æ’åºã€‚

![https://ithelp.ithome.com.tw/upload/images/20241005/20135197D5PSky96wh.png](https://ithelp.ithome.com.tw/upload/images/20241005/20135197D5PSky96wh.png)
> [ç·šä¸ŠæŸ¥çœ‹å‹•ç•«æ•ˆæœ](https://jerry-the-potato.github.io/vite-deploy/#SortAlgorithm)
### äºŒå…ƒæ¨¹çµæ§‹
æˆ‘å€‘å…ˆä¾†ä»‹ç´¹è³‡æ–™çµæ§‹ï¼Œé€™å€‹çµæ§‹çš„å¥½è™•æ˜¯ï¼Œå¯ä»¥åˆ©ç”¨é™£åˆ—ä¾†å„²å­˜ç¯€é»ï¼Œä¸¦ä¸”é€éä¸€å€‹ç°¡å–®çš„ç´¢å¼•è¦å‰‡æ‰¾åˆ°æ¯å€‹çˆ¶ç¯€é»çš„å­ç¯€é»ã€‚ä¸¦é™å®šæ¯å€‹ç¯€é»æœ€å¤šæ“æœ‰å…©å€‹å­ç¯€é»ï¼Œæ‰€æœ‰å±¤çš„ç¯€é»éƒ½æ˜¯å¾å·¦è‡³å³æ’åˆ—ç·Šå¯†çš„ã€‚

#### ç´¢å¼•è¦å‰‡
* æ¯å€‹ç¯€é» ğ‘– çš„å·¦å­ç¯€é»çš„ç´¢å¼•å€¼ç‚ºï¼š2 Ã— ğ‘– + 1
* æ¯å€‹ç¯€é» ğ‘– çš„å³å­ç¯€é»çš„ç´¢å¼•å€¼ç‚ºï¼š2 Ã— ğ‘– + 2

å‡è¨­æˆ‘å€‘æœ‰ä¸€å€‹åŒ…å« 7 å€‹ç¯€é»çš„å®Œå…¨äºŒå…ƒæ¨¹ï¼Œå¯ä»¥å°‡å…¶ç”¨é™£åˆ—è¡¨ç¤ºç‚ºï¼š
[é»ƒ0,ç´…1,ç´…2,è—3,è—4,è—5,è—6]

å…¶ä¸­ä¸‰å€‹é¡è‰²åˆ†åˆ¥ä»£è¡¨ä¸åŒéšå±¤
1. æ ¹ç¯€é»ï¼ˆé»ƒ0ï¼‰æ˜¯é™£åˆ—ä¸­çš„ç¬¬ 0 å€‹å…ƒç´ ï¼Œå®ƒçš„å…©å€‹å­ç¯€é»æ˜¯ï¼š
    * ç´…1ï¼š2 Ã— 0 + 1 = 1
    * ç´…2ï¼š2 Ã— 0 + 2 = 2
2. ç¯€é»ï¼ˆç´…1ï¼‰æ˜¯ç¬¬ 1 å€‹å…ƒç´ ï¼Œå®ƒçš„å…©å€‹å­ç¯€é»æ˜¯ï¼š
    * è—3ï¼š2 Ã— 1 + 1 = 3
    * è—4ï¼š2 Ã— 1 + 2 = 4
3. ç¯€é»ï¼ˆç´…2ï¼‰æ˜¯ç¬¬ 2 å€‹å…ƒç´ ï¼Œå®ƒçš„å…©å€‹å­ç¯€é»æ˜¯ï¼š
    * è—5ï¼š2 Ã— 2 + 1 = 5
    * è—6ï¼š2 Ã— 2 + 2 = 6

### å †æ’åº
å †æ’åºçš„æ ¸å¿ƒæ¦‚å¿µæ˜¯é€šéå»ºç«‹æœ€å¤§å †ä¾†å°‡æ•¸åˆ—é€²è¡Œæ’åºã€‚åœ¨æœ€å¤§å †ä¸­ï¼Œæ¯å€‹çˆ¶ç¯€é»çš„å€¼éƒ½å¤§æ–¼æˆ–ç­‰æ–¼å…¶å­ç¯€é»çš„å€¼ã€‚æ¥è‘—ï¼Œæˆ‘å€‘é€šéåè¦†å°‡æœ€å¤§å †çš„å †é ‚å…ƒç´ ç§»åˆ°é™£åˆ—æœ«ç«¯ï¼Œä¸¦å°å‰©é¤˜çš„éƒ¨åˆ†é‡æ–°èª¿æ•´å †ï¼Œä¾†å®Œæˆæ’åºéç¨‹ã€‚

```javascript
function heapSort(arr) {
    const n = arr.length;
    for (let i = Math.floor(n / 2) - 1; i >= 0; i--) heapify(arr, n, i);
    for (let i = n - 1; i > 0; i--) {
        [arr[0], arr[i]] = [arr[i], arr[0]];
        heapify(arr, i, 0);
    }
    return arr;
}

function heapify(arr, n, i) {
    let largest = i;
    let left = 2 * i + 1;
    let right = 2 * i + 2;
    if (left < n && arr[left] > arr[largest]) largest = left;
    if (right < n && arr[right] > arr[largest]) largest = right;
    if (largest !== i) {
        [arr[i], arr[largest]] = [arr[largest], arr[i]];
        heapify(arr, n, largest);
    }
}
```

é€™å€‹æ–¹æ³•çš„è°æ˜ä¹‹è™•åœ¨æ–¼ï¼Œå»ºç«‹å¥½æœ€å¤§å †å¾Œï¼Œæˆ‘å€‘åƒ…åƒ…æŠŠæœ€å¤§å€¼å’Œæœ«å°¾é€²è¡Œäº¤æ›ï¼Œæ­¤æ™‚æˆ‘å€‘åªéœ€è¦æ‰¾åˆ°ä¸‹ä¸€å€‹æœ€å¤§å€¼ï¼Œä¸¦é€šéå±¤å±¤äº¤æ›æŠŠå®ƒæ“ºä¸Šæœ€ä¸Šå±¤ï¼Œå°±å†ä¸€æ¬¡å®Œæˆæœ€å¤§å †çš„æ’åºäº†ã€‚

### è¿­ä»£æ–¹ç¨‹å¼
ç‚ºäº†å¯¦ç¾å‹•ç•«æ•ˆæœï¼Œæˆ‘å€‘å°‡å †æ’åºçš„éç¨‹åˆ†ç‚ºä¸‰å€‹éšæ®µï¼š**å»ºå †**ã€**äº¤æ›**ã€å’Œ**æ’åº**ã€‚åœ¨é€™è£¡ï¼Œåˆ©ç”¨å’Œå‰å¹¾æ¬¡ç›¸åŒçš„ç‹€æ…‹ç®¡ç†æ¶æ§‹ï¼Œä¸¦é€éä¸åŒçš„éšæ®µä¾†é€æ­¥å‘ˆç¾è¦–è¦ºåŒ–å‹•ç•«æ•ˆæœã€‚é€™æ¨£çš„è¨­è¨ˆå¯ä»¥è®“æ¯å€‹æ’åºæ­¥é©Ÿæ¸…æ™°å¯è¦‹ï¼Œä¸¦å…è¨±æˆ‘å€‘æ§åˆ¶å‹•ç•«çš„é€²åº¦ã€‚
```javascript
class SortAlgorithm{
    heapSortSetting(columns){
        this.i = Math.floor(columns.length / 2) - 1;
        this.j = this.i;
        this.heapPhase = "1.build";
    }
    heapSort(columns){
        const len = columns.length;
        const i = this.i;
        const j = this.j;
        switch(this.heapPhase){
            case "1.build":
            case "2.swap":
            case "3.sort":
        }
    }
}
```

#### éšæ®µï¼‘ï¼šå»ºå †
åœ¨å»ºå †éšæ®µï¼Œæˆ‘å€‘å°‡å¾æ•¸åˆ—çš„ä¸­é–“åå·¦é–‹å§‹ï¼Œå‘å·¦é€æ­¥å°æ¯å€‹ç¯€é»é€²è¡Œ heapifyï¼Œå°‡å…¶è½‰æ›ç‚ºæœ€å¤§å †ã€‚å¦‚æœæ‰€æœ‰ç¯€é»éƒ½å·²è™•ç†å®Œï¼Œæˆ‘å€‘æœƒé€²å…¥ä¸‹ä¸€éšæ®µï¼Œé–‹å§‹äº¤æ›ã€‚
```javascript
case "1.build":
    this.j = SortAlgorithm.heapify(columns, len, j);
    if(this.j == -1){
        this.i--;
        this.j = this.i;
        if(this.i < 0){
            this.i = len - 1;
            this.j = 0;
            this.heapPhase = "2.swap";
        }
    }
    break;
```
é¸åœ¨ä¸­é–“ç›¸ç•¶æ–¼å¾äºŒå…ƒæ¨¹çš„æœ€åº•å±¤é–‹å§‹ï¼Œç•¶å®ƒå„²å­˜åœ¨é™£åˆ—ä¸­ï¼Œè¡¨ç¤ºæœ€å¾Œä¸€çµ„çˆ¶å­é—œä¿‚çš„ç´¢å¼•å€¼æ˜¯[ä¸­é–“, ä¸­é–“ * 2 +1, ä¸­é–“ * 2 + 2]
#### éšæ®µï¼’ï¼šäº¤æ›
åœ¨äº¤æ›éšæ®µï¼Œæˆ‘å€‘å°‡å †é ‚çš„æœ€å¤§å…ƒç´ èˆ‡é™£åˆ—æœ«ç«¯çš„å…ƒç´ äº¤æ›ï¼Œé€™æ¨£æœ€å¤§å€¼å°±è¢«ç§»åˆ°äº†é™£åˆ—çš„æ­£ç¢ºä½ç½®ã€‚
```javascript
case "2.swap":
    const a = columns[0];
    const b = columns[i];
    SortAlgorithm.swapColumn(a, b, 60);
    this.heapPhase = "3.sort";
    break;
```

#### éšæ®µï¼“ï¼šæ’åº
æœ€å¾Œï¼Œæˆ‘å€‘å°å‰©é¤˜çš„éƒ¨åˆ†å†æ¬¡é€²è¡Œ heapifyï¼Œä¸¦é‡è¤‡ä¸Šä¸€æ­¥é©Ÿï¼Œç›´åˆ°æ‰€æœ‰å…ƒç´ éƒ½å·²æ’åºå®Œæˆã€‚
```javascript
case "3.sort":
    this.j = SortAlgorithm.heapify(columns, i, j);
    if(this.j == -1){
        this.j = 0;
        this.i--;
        this.heapPhase = "2.swap";
        if(this.i < 0) return true;
    }
    break;
```

#### Heapify å‡½å¼å¯¦ä½œ
å»ºå †çš„æ–¹å¼å’Œç¯„ä¾‹ç¨‹å¼ç¢¼ç›¸åŒï¼Œè¦æ³¨æ„çš„åœ°æ–¹åœ¨æ–¼ï¼Œåœ¨ä¸èƒ½ä½¿ç”¨éè¿´çš„å‰æä¸‹ï¼Œæˆ‘å€‘åˆ©ç”¨å›å‚³å€¼ä¾†é€²è¡Œä¸‹ä¸€æ¬¡çš„ heapifyï¼Œä»¥æ­¤é”åˆ°è¿­ä»£çš„æ•ˆæœã€‚
```javascript
class SortAlgorithm{
    static heapify(columns, len, i){
        let largest = i;
        const left = 2 * i + 1;
        const right = 2 * i + 2;
        if (left < len && columns[left].height > columns[largest].height) {
            largest = left;
        }
        if (right < len && columns[right].height > columns[largest].height) {
            largest = right;
        }
        if (largest !== i) {
            const a = columns[i];
            const b = columns[largest];
            SortAlgorithm.swapColumn(a, b, 60);
            return largest;
        }
        return -1;
    }
}
```
é€™é‚Šå¯ä»¥ç‰¹åˆ¥å¼·èª¿çš„æ˜¯ï¼ŒäºŒå…ƒæ¨¹çš„ç©ºé–“å¤§å°æ˜¯ 2^n - 1ï¼Œæˆ‘å€‘çš„è³‡æ–™æœ‰å¯èƒ½å°æ–¼é€™å€‹ç©ºé–“ï¼Œå› æ­¤ï¼Œåœ¨ heapify çš„æ™‚å€™æœƒå…ˆæª¢æŸ¥å­ç¯€é»æ˜¯å¦å­˜åœ¨ï¼Œæ˜¯å¦è¶…å‡ºé™£åˆ—ç¯„åœ

### è¿­ä»£å™¨å’Œç”Ÿæˆå™¨
æ¥ä¸‹ä¾†è®“æˆ‘å€‘ä»‹ç´¹å¦‚ä½•ä½¿ç”¨ç”Ÿæˆå™¨ï¼ˆGeneratorsï¼‰ä¾†å¯¦ä½œ å †æ’åºï¼ˆHeap Sortï¼‰ çš„è¿­ä»£ç‰ˆæœ¬ï¼Œç°¡ç›´æ˜¯ä¸è²»å¹ç°ä¹‹åŠ›ï¼Œå°±å¾ç¯„ä¾‹ç¨‹å¼ç¢¼æ”¹æˆæˆ‘å€‘æ‰€éœ€çš„è¦–è¦ºåŒ–ç‰ˆæœ¬äº†ï¼

#### ä¸»è¦éšæ®µ
ç”Ÿæˆå™¨åœ¨ JavaScript ä¸­æ˜¯ä¸€ç¨®ç‰¹æ®Šçš„å‡½æ•¸ï¼Œå…è¨±å‡½æ•¸çš„åŸ·è¡Œè¢«æš«åœå’Œæ¢å¾©ï¼Œä¸¦å¯ä»¥åœ¨æ¯æ¬¡å‘¼å« yield æ™‚è¿”å›ç•¶å‰ç‹€æ…‹ã€‚åœ¨é€™è£¡è² è²¬åŸ·è¡Œå…©å€‹ä¸»è¦éšæ®µï¼š**å»ºå †**ã€**æ’åº**
```javascript
class SortAlgorithmIterable{
    * heapSortMaker(columns) {
        const n = columns.length;
        for (let i = Math.floor(n / 2) - 1; i >= 0; i--) {
            yield* this.heapify(columns, n, i);
        }
        for (let i = n - 1; i > 0; i--) {
            const a = columns[0];
            const b = columns[i];
            SortAlgorithm.swapColumn(a, b, 60);
            yield* this.heapify(columns, i, 0);
        }
        yield true;
    }
}
```
#### Heapify
å’Œå‰é¢é‚è¼¯ç›¸åŒï¼Œåœ¨é€™è£¡æˆ‘å€‘ä¸éœ€è¦é€šéå›å‚³å€¼ä¾†æ‰‹å‹•è¿­ä»£ï¼Œå¯ä»¥é€é yield* ä¾†å‘¼å«éè¿´å‡½å¼ã€‚
```javascript
class SortAlgorithmIterable{
    * heapify(columns, n, i) {
        yield false;
        let largest = i;
        let left = 2 * i + 1;
        let right = 2 * i + 2;
        if (left < n && columns[left].height > columns[largest].height) largest = left;
        if (right < n && columns[right].height > columns[largest].height) largest = right;
        if (largest !== i) {
            const a = columns[largest];
            const b = columns[i];
            SortAlgorithm.swapColumn(a, b, 60);
            yield* this.heapify(columns, n, largest);
        }
    }
}
```

### **çµè«–**
å †æ’åºçš„ç¨‹å¼ç¢¼é›–ç„¶ç°¡æ½”ï¼Œç©ºé–“æ¦‚å¿µç›¸å°ä¾†èªªæ¯”å…¶ä»–æ’åºæ¼”ç®—æ³•è¦ç¨å¾®è¤‡é›œä¸€äº›ï¼Œå› ç‚ºå®ƒæ¶‰åŠåˆ°æ¨¹ç‹€çµæ§‹çš„èª¿æ•´å’Œå¤šéšæ®µçš„æ“ä½œã€‚å„˜ç®¡å¦‚æ­¤ï¼Œæˆ‘å€‘ä»ç„¶å¯ä»¥é€šéåˆç†çš„ç‹€æ…‹æ©Ÿè¨­è¨ˆï¼Œå°‡æ¯å€‹æ­¥é©Ÿé€ä¸€å±•ç¾ï¼Œä¸¦ä¿æŒæ’åºçš„å¯è¦–åŒ–å’Œå‹•ç•«æ•ˆæœã€‚

è€ŒåŸºæ–¼ç”Ÿæˆå™¨çš„å †æ’åºä¸åƒ…èƒ½å¤ ä¿ç•™åŸæœ¬æ¼”ç®—æ³•çš„çµæ§‹ï¼Œé‚„å¯ä»¥æ¸…æ™°åœ°è§€å¯Ÿæ¯å€‹æ’åºæ­¥é©Ÿï¼Œè®“æˆ‘å€‘å°æ¼”ç®—æ³•çš„å…§éƒ¨é‹ä½œæœ‰äº†æ›´å…·é«”çš„ç†è§£ã€‚éš¨è‘—ç”Ÿæˆå™¨çš„æ‡‰ç”¨ï¼Œå‹•ç•«åŒ–çš„éè¿´æµç¨‹è®Šå¾—æ›´åŠ è¼•é¬†å’Œé«˜æ•ˆï¼Œå±•ç¤ºäº†ç”Ÿæˆå™¨åœ¨è™•ç†è¤‡é›œé‚è¼¯çš„éˆæ´»æ€§ã€‚
